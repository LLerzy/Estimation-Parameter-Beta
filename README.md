# Posterior Estimation of Beta Distribution Parameters: Proposal and Comparison

This repository is a branch of a main repository called **[Estimation-Parameter-Beta](https://github.com/LLerzy/Estimation-Parameter-Beta)**.

## Table of Contents

-   [Overview](#overview)
-   [Installation](#installation)
-   [Usage](#usage)
-   [Included Functions](#included-functions)
-   [Branches](#branches)
-   [Contributions](#contributions)

## Overview

From the Bayesian perspective, the estimation of the parameters $(\alpha, \beta)$ of the Beta distribution can be performed using Jeffreys' prior, the product of Gamma distributions (with hyperparameter values reflecting uninformation or those obtained through the Expectation-Maximization method), or the conjugate prior distribution. However, these priors have limitations, as they do not allow the incorporation of external information into the sample, and one of them assumes independence between the parameters.

The code presented is written in Python and conducts a simulation study to compare the performance of traditional estimations (both classical and Bayesian) with those generated by a new bivariate joint distribution, used as a prior for $(\alpha, \beta)$, which enables the integration of external information into the sample.

The simulation of the posterior chains is carried out using a Metropolis-Hastings method based on random walks, employing the product of Log-Normal distributions as the instrumental distribution. The metrics used to compare the performance include: posterior estimation, bias, mean squared error, coverage probability, and average length of the credibility intervals for the Bayesian approach. In contrast, for the classical approach, bootstrap intervals are used.

## Installation

El código puede ser accesado y ejecutado a través de Colaboratory de Google. Los paquetes o librerias utilizadas no requiere instalación, las utilizadas pueden ser agrupadas de la siguiente manera:

### Numerical Computation and Special Functions
- `numpy`
- `math`
- `scipy.special`

### Optimization and Root Finding
- ``scipy.optimize import newton, brentq, bisect, minimize
### Statistical Distributions and Bootstrapping
- `scipy.stats`
### Data Manipulation and Parallel Processing
- `pandas`
- `joblib`
### Visualization
- `matplotlib.pyplot`
- `seaborn`
### Statistical Models
- `statsmodels.api`

## Usage

To run the designed algorithms, follow these steps:

1. Guarde en su Drive de Google la hoja de cálculo [``]

    ``` bash
    git clone https://github.com/LLerzy/Estimation-Parameter-Beta/tree/main.git
    ```

2. Open the R script in any compatible Integrated Development Environment (IDE):

    -   For the script that contains the main functions in the shape parameter estimation process, refer to [`requiredfunctions.R`](https://github.com/LLerzy/Estimation-Parameter-Beta/blob/Post-Estimate/requiredfunctions.R).

3. You can run the script and load all the functions with the following command:

    ``` bash
    Rscript requiredfunctions.R
    ```

## Included Functions

The functions defined in the `requiredfunctions.R` script include:

-   `Prior`: Defines the proposed prior probability density function, referred to as combination 1 in the [New-Biv-Dist](https://github.com/LLerzy/Estimation-Parameter-Beta/tree/New-Biv-Dist) branch.
-   `FC_X1_Given_v`: Full conditional distribution of $X_1$ given $X_2 = v$.
-   `Graph_Fc_X1`: Plots the full conditional distribution for given parameter values.
-   `Gen_FC_X1_X2`: Metropolis-Hastings algorithm with random walk to generate samples from the full conditional distribution.
-   `Mon_Measure`: Monitors acceptance rates and ESS (effective sample size) for different values of $v$ and precision.
-   `Mon_R_Hat`: Monitors the Gelman-Rubin diagnostic ($R$-hat) for different values of $v$ and precision.
-   `Graphs`: Generates histograms, density plots, trace plots, and convergence diagnostics using averages.
-   `Gen_Joint_Dist`: Gibbs sampling to generate samples from the joint distribution of the random vector $(X_1,X_2)$.
-   `Mtovar_vs2`: Generalizes Tovar’s method to obtain hyperparameter values.
-   `Mom_Prior_Dist`: Computes the joint moments of order $l$ for the proposed prior distribution.
-   `Measure_Diagnostic`: Compares analytical and numerical results for user-provided data samples.
-   `Measure_Analy`: Computes the analytical results for the proposed prior distribution.
-   `Hyperparameters`: Obtains hyperparameter values using empirical and subjective Bayesian approaches.
-   `Est_Post`: Posterior estimation of the Beta distribution's shape parameters $\alpha$ and $\beta$ using importance sampling.
-   `Sim_study`: Conducts simulation studies to compare posterior estimates using different hyperparameters and sample sizes.
-   `Individual_Graphs`: Creates individual graphs to monitor posterior estimates using bias and MSE as indicators.
-   `Comparison_Hyper`: Compares joint density functions for different sets of hyperparameters.

### Notes:

-   It is recommended to review and adapt each function according to the specific needs of each analysis.
-   Make sure you understand each function before using it to ensure accurate results and avoid potential errors.

## Branches

The following branches are available in this repository:

-   [**New-Biv-Dist**](https://github.com/LLerzy/Estimation-Parameter-Beta/tree/New-Biv-Dist): Presents numerically approximated characteristics for seven of the 25 proposed probability distributions representing the random behavior of the Beta distribution’s shape parameters. Additionally, some numerical and theoretical approximations for combination 1 are compared.
-   [**Algorithm-Sim-Samples**](https://github.com/LLerzy/Estimation-Parameter-Beta/tree/Algorithm-Sim-Samples): Monitors the convergence of chains generated by an algorithm using MCMC methods to generate random samples from a new proposed probability distribution, referred to as combination 1 in the [New-Biv-Dist](https://github.com/LLerzy/Estimation-Parameter-Beta/tree/New-Biv-Dist) branch.
-   [**Post-Estimate**](https://github.com/LLerzy/Estimation-Parameter-Beta/tree/Post-Estimate): Conducts a simulation study to estimate the shape parameters of the Beta distribution. This study involves: two questions that can be used in an elicitation process, hyperparameter determination methods, three scenarios for the shape parameters, hypothetical expert information with different levels of bias, and graphs comparing posterior estimators through mean estimation, bias, mean squared error, coverage probability, and average length.

## Contributions

Contributions are welcome! Please submit a pull request or open an issue if you have any suggestions or improvements.
