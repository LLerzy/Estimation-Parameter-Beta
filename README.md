# Posterior Estimation of Beta Distribution Parameters: Proposal and Comparison

This repository is a branch of a main repository called **[Estimation-Parameter-Beta](https://github.com/LLerzy/Estimation-Parameter-Beta)**.

## Table of Contents

-   [Overview](#overview)
-   [Execution and Dependencies](#execution-and-dependencies)
-   [Usage](#usage)
-   [Included Functions](#included-functions)
-   [Contributions](#contributions)

## Overview

From the Bayesian perspective, the estimation of the parameters $(\alpha, \beta)$ of the Beta distribution can be performed using Jeffreys' prior, the product of Gamma distributions (with hyperparameter values reflecting uninformation or those obtained through the Expectation-Maximization method), or the conjugate prior distribution. However, these priors have limitations, as they do not allow the incorporation of external information into the sample, and one of them assumes independence between the parameters.

The code presented is written in Python and conducts a simulation study to compare the performance of traditional estimations (both classical and Bayesian) with those generated by a new bivariate joint distribution, used as a prior for $(\alpha, \beta)$, which enables the integration of external information into the sample.

The simulation of the posterior chains is carried out using a Metropolis-Hastings method based on random walks, employing the product of Log-Normal distributions as the instrumental distribution. The metrics used to compare the performance include: posterior estimation, bias, mean squared error, coverage probability, and average length of the credibility intervals for the Bayesian approach. In contrast, for the classical approach, bootstrap intervals are used.

## Execution and Dependencies 

This project can be accessed and executed through **Google Colaboratory**. The required packages are pre-installed in Colab, meaning no additional installation is needed.  The libraries used in this project can be grouped as follows:

### Numerical Computation and Special Functions
- `numpy`
- `math`
- `scipy.special` (includes `polygamma`, `gammaln`)

### Optimization and Root Finding
- `scipy.optimize` (includes `newton`, `brentq`, `bisect`, `minimize`)

### Statistical Distributions and Bootstrapping
- `scipy.stats` (includes `multivariate_normal`, `lognorm`, `bootstrap`)

### Data Handling and Parallel Processing
- `pandas`
- `joblib` (includes `Parallel`, `delayed`)

### Visualization
- `matplotlib.pyplot`
- `seaborn`

### Statistical Models
- `statsmodels.api`

### Google Colaboratory and Google Sheets Integration
- `gspread`
- `google.colab.auth`
- `google.auth`
- `gspread_dataframe`  

## Usage

To run the designed algorithms, follow these steps:

1. Download and save the spreadsheet [`Results_of_simulations_executed.xlsx`](https://github.com/LLerzy/Estimation-Parameter-Beta/blob/Comparison/Results_of_simulations_executed.xlsx) to your Google Drive.

2. Access the designed algorithm [`Metropolis_Hasting`](https://github.com/LLerzy/Estimation-Parameter-Beta/blob/Comparison/Metropolis_Hasting(GitHub).ipynb) and create a copy in your Google Drive.

## Included Functions

The functions defined in this project include:

- `metropolis_hastings`: Implements the Metropolis-Hastings algorithm with a bivariate target distribution, proposal sampling, and an acceptance rate calculation, incorporating thinning and burn-in.
- `proposal_sampler`: Generates proposals from a **bivariate Log-Normal distribution**, ensuring positivity in the Metropolis-Hastings sampling process.
- `proposal_pdf`: Computes the probability density function of the **proposal distribution** (product of Log-Normal distributions), given current and proposed values.
- `monitor_convergence`: Generates **trace plots, histograms, scatter plots, and autocorrelation plots** to evaluate the convergence of the Markov chains.
- `post_prior_gammas`: Computes the **posterior density function** for a Beta distribution with a **Gamma prior**, ensuring numerical stability using logarithmic transformations.
- `post_prior_Jeffrey`: Evaluates the **posterior density function** under **Jeffrey’s prior**, incorporating second-order polygamma functions for a **noninformative prior structure**.
- `post_new_prior`: Implements a **new bivariate prior** for the Beta distribution, with hyperparameter values obtained using a proposed strategy.
- `target_pdf`: Defines the **bivariate target distribution**, used within the Metropolis-Hastings algorithm, incorporating the specified **prior structure and observed data**.
- `solve_with_fallback`: Attempts to solve an equation using **Newton-Raphson's method**, switching to **Brent’s method** if convergence is not achieved.
- `EM_Size`: Executes the **Expectation-Maximization (EM) algorithm** for Bayesian estimation of Beta distribution parameters across different **sample sizes and scenarios**, using Metropolis-Hastings for posterior sampling.
- `plot_results`: Generates a set of **line plots** displaying the estimation behavior for **bias, mean squared error (MSE), coverage, and interval length** as a function of sample size.
- `generate_beta_samples`: Generates samples from the Beta distribution, with parameter values and sample size specified by the researcher.
- `mle_estimation`: Computes the **maximum likelihood estimation (MLE)** for the Beta distribution parameters.
- `method_of_moments`: Computes the **method of moments estimation** for the Beta distribution parameters.
- `bootstrap_intervals`: Constructs the **Bootstrap distribution** for a given estimation method.
- `calculate_metrics`: Computes **descriptive measures** for a given dataset.
- `process_scenario`: Specifies all estimation methods used in the simulation study.
- `comparative_study`: Parallelized execution of the **process_scenario** function for efficiency.

### Notes:

-   It is recommended to review and adapt each function according to the specific needs of each analysis.
-   Make sure you understand each function before using it to ensure accurate results and avoid potential errors.

## Contributions

Contributions are welcome! Please submit a pull request or open an issue if you have any suggestions or improvements.
